<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Polychain F1 — Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Libre+Baskerville&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <style>
    :root{
      --ink:#111; --rule:#e6e6e6;
      --heading-font:"Playfair Display", Georgia, "Times New Roman", serif;
      --body-font:"Libre Baskerville", Georgia, "Times New Roman", serif;
      --tab:#111; --tabOff:#888; --tabBg:#fff;
    }
    html,body{
      margin:0; padding:0; background:#fff; color:var(--ink);
      font-family:var(--body-font); font-size:16px; line-height:1.5;
    }
    .page{max-width:1100px; margin:28px auto; padding:28px; border:4px solid #000; box-sizing:border-box;}

    /* Header */
    .hero{
      display:flex; flex-direction:column; align-items:center; gap:10px;
      margin-bottom:18px; border-bottom:1px solid var(--rule); padding-bottom:18px;
    }
    .hero img{width:120px; height:120px; object-fit:contain;}
    .hero h1{
      font-family:var(--heading-font);
      font-size:44px; line-height:1.1; margin:0; text-align:center; letter-spacing:-0.5px;
    }
    .f1{ display:inline-flex; align-items:flex-end; }
    .f1 .f{ font-size:1em; line-height:1; }
    .f1 .one{
      font-variant-numeric: lining-nums tabular-nums;
      display:inline-block; font-size:1.08em; line-height:1; position:relative; top:1px;
    }

    /* Tabs */
    .tabs{
      display:flex; gap:10px; flex-wrap:wrap; margin:14px 0 18px;
      border-bottom:1px solid var(--rule); padding-bottom:10px;
      justify-content:center;
    }
    .tabs a{
      text-decoration:none; color:var(--tabOff); background:var(--tabBg);
      border:1px solid var(--tabOff); padding:6px 12px; border-radius:18px;
      font:600 13px/1 var(--body-font);
    }
    .tabs a.active{color:#fff; background:var(--tab); border-color:var(--tab);}

    /* Section headings + canvases */
    h2{
      font-family:var(--heading-font);
      font-size:22px;
      font-weight:700;
      text-align:center;
      margin:22px 0 8px;
    }
    canvas{max-width:100%; height:420px; margin:0 auto 30px; display:block; background:#fff;}

    /* Range toolbar (centered under titles) */
    .toolbar{
      display:flex; justify-content:center; gap:10px; margin:8px 0 16px;
    }
    .toolbar button{
      appearance:none; border:1px solid #111; background:#fff; color:#111;
      padding:6px 10px; border-radius:18px; font:600 13px/1 var(--body-font); cursor:pointer;
    }
    .toolbar button.on{background:#111; color:#fff;}

    /* Chart + stats layout */
    .chart-row{
      display:grid;
      grid-template-columns: 1fr 280px;
      gap:24px;
      align-items:center;
      margin: 18px 0 36px;
    }
    @media (max-width: 1000px){
      .chart-row{ grid-template-columns: 1fr; }
    }
    .statbox{
      border:1px solid var(--rule);
      border-radius:12px;
      padding:12px;
      background:#fff;
      min-height:120px;
      align-self:center;
    }

    /* Dynamic stat cards */
    .stat-card + .stat-card { margin-top:10px; }
    .stat-title{
      display:flex; justify-content:space-between; align-items:center;
      font-weight:700; margin-bottom:6px;
    }
    .stat-title::after{ content:"Change"; color:#777; font-weight:600; font-size:12px; }
    .stat-row{
      display:grid; grid-template-columns: 3.2rem 1fr; gap:8px; align-items:center; padding:3px 0;
    }
    .stat-row span:first-child{ color:#333; }
    .stat-row strong{ justify-self:end; font-feature-settings:"tnum" 1; letter-spacing:.2px; }
    .stat-row strong.pos { color:#0a7a3c; }
    .stat-row strong.neg { color:#b21c1c; }

    .badge-up{ color:#0a7a3c; font-weight:600; }
    .badge-down{ color:#b21c1c; font-weight:600; }
    .muted{ color:#777; font-size:12px; }

    /* Tab panes */
    .tabpane{display:none;}
    .tabpane.active{display:block;}

    /* ===== Performance tab styles (id must be #pane-performance) ===== */
    #pane-performance .panel-header { display:flex; justify-content:space-between; align-items:center; margin:12px 0; }
    #pane-performance .range-switch { display:flex; gap:8px; }
    #pane-performance .rng { padding:6px 10px; border:1px solid #ddd; border-radius:18px; background:#fff; cursor:pointer; font:600 13px/1 var(--body-font); }
    #pane-performance .rng.active { background:#111; color:#fff; border-color:#111; }
    #perf-table { width:100%; border-collapse:collapse; }
    #perf-table th, #perf-table td { padding:10px 8px; border-bottom:1px solid #eee; }
    #perf-table th { text-align:left; }
    #perf-table td:nth-child(2), #perf-table td:nth-child(3) { text-align:right; }
    #perf-table tbody tr { cursor:pointer; }

    /* NEW: relative performance picker + framed chart */
    .relperf{ margin-top:8px; }
    .asset-picker{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin:8px 0 6px;
      max-height:112px;
      overflow:auto;
      justify-content:center; /* centered chips */
    }
    .asset-btn{padding:6px 10px;border:1px solid #ddd;border-radius:18px;background:#fff;cursor:pointer;font:600 12px/1 var(--body-font);}
    .asset-btn.on{background:#111;color:#fff;border-color:#111;}
    .tz-note{ text-align:right; color:#666; font-size:12px; margin:0 4px 6px; }

    /* Fixed-size frame that prevents the canvas from stretching the page */
    .relperf-frame{
      position:relative;
      width:100%;
      height:360px;             /* <- adjust once if you want a different height */
      margin:8px 0 16px;
      background:#fff;
      border:1px solid #eee;
      border-radius:8px;
    }
    .relperf-frame canvas{
      position:absolute;
      inset:0;
      width:100% !important;
      height:100% !important;
      display:block;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- Logo + title -->
    <div class="hero">
      <img src="assets/polychain-logo.gif" alt="Polychain logo" />
      <h1>Polychain <span class="f1"><span class="f">F</span><span class="one">1</span></span> Dashboard</h1>
    </div>

    <!-- Tabs -->
    <nav class="tabs" id="tabs">
      <a href="#pump" class="active">PUMP</a>
      <a href="#dats">DATs</a>
      <a href="#hype">HYPE</a>
      <a href="#risk">Risk</a>
      <a href="#performance" id="tab-performance" class="tab">Performance</a>
    </nav>

    <!-- Pump tab -->
    <section id="pane-pump" class="tabpane active">
      <!-- Price vs Fees -->
      <div class="chart-row">
        <div>
          <h2>PUMP — Price vs Fees</h2>
          <div class="toolbar" data-for="chart">
            <button class="on" data-range="ALL">All</button>
            <button data-range="3M">3M</button>
            <button data-range="1M">1M</button>
            <button data-range="1W">1W</button>
          </div>
          <canvas id="chart"></canvas>
        </div>
        <aside class="statbox" id="stats-chart"></aside>
      </div>

      <!-- Price vs Revenue -->
      <div class="chart-row">
        <div>
          <h2>PUMP — Price vs Revenue</h2>
          <div class="toolbar" data-for="chart-revenue">
            <button class="on" data-range="ALL">All</button>
            <button data-range="3M">3M</button>
            <button data-range="1M">1M</button>
            <button data-range="1W">1W</button>
          </div>
          <canvas id="chart-revenue"></canvas>
        </div>
        <aside class="statbox" id="stats-chart-rev"></aside>
      </div>

      <!-- Price vs Buybacks (USD) -->
      <div class="chart-row">
        <div>
          <h2>PUMP — Price vs Buybacks (USD)</h2>
          <div class="toolbar" data-for="chart-buybacks">
            <button class="on" data-range="ALL">All</button>
            <button data-range="3M">3M</button>
            <button data-range="1M">1M</button>
            <button data-range="1W">1W</button>
          </div>
          <canvas id="chart-buybacks"></canvas>
        </div>
        <aside class="statbox" id="stats-chart-bb"></aside>
      </div>

      <!-- Cumulative Buybacks vs Circulating Market Cap -->
      <div class="chart-row">
        <div>
          <h2>PUMP — Cumulative Buybacks vs Circulating Market Cap</h2>
          <div class="toolbar" data-for="chart-bbmcap">
            <button class="on" data-range="ALL">All</button>
            <button data-range="3M">3M</button>
            <button data-range="1M">1M</button>
            <button data-range="1W">1W</button>
          </div>
          <canvas id="chart-bbmcap"></canvas>
        </div>
        <aside class="statbox" id="stats-chart-bbmcap"></aside>
      </div>
    </section>

    <!-- DATs -->
    <section id="pane-dats" class="tabpane">
      <h2>DATs (placeholder)</h2>
      <p>DAT info will go here.</p>
    </section>

    <!-- HYPE -->
    <section id="pane-hype" class="tabpane">
      <h2>HYPE (placeholder)</h2>
      <p>All things HYPE will go here.</p>
    </section>

    <!-- Risk -->
    <section id="pane-risk" class="tabpane">
      <h2>Risk (placeholder)</h2>
      <p>XYZ.</p>
    </section>

    <!-- Performance tab pane (id must be pane-performance) -->
    <section id="pane-performance" class="tabpane">
      <div class="panel-header">
        <h2>Performance</h2>
        <div class="range-switch">
          <button class="rng" data-range="24H">24H</button>
          <button class="rng" data-range="1W">1W</button>
          <button class="rng" data-range="1M">1M</button>
          <button class="rng" data-range="3M">3M</button>
          <button class="rng active" data-range="YTD">YTD</button>
        </div>
      </div>

      <!-- Relative performance (fixed-size frame) -->
      <div class="relperf">
        <div id="relperf-picker" class="asset-picker"></div>
        <div class="tz-note">Times shown in Eastern Time (ET)</div>
        <div class="relperf-frame">
          <canvas id="relperf-chart"></canvas>
        </div>
      </div>

      <div class="table-wrap">
        <table id="perf-table">
          <thead>
            <tr>
              <th>Asset</th>
              <th>Price</th>
              <th>Change</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </div>

  <!-- Tab router -->
  <script>
    (function () {
      const links = Array.from(document.querySelectorAll('#tabs a'));
      const panes = {
        pump: document.getElementById('pane-pump'),
        dats: document.getElementById('pane-dats'),
        hype: document.getElementById('pane-hype'),
        risk: document.getElementById('pane-risk'),
        performance: document.getElementById('pane-performance'),
      };
      function activate(name) {
        const target = name.toLowerCase();
        links.forEach(a => {
          const href = a.getAttribute('href').slice(1).toLowerCase();
          a.classList.toggle('active', href === target);
        });
        Object.entries(panes).forEach(([k, el]) => el.classList.toggle('active', k === target));
        if (target === 'pump' && window.__charts) {
          Object.values(window.__charts).forEach(obj => obj?.chart?.resize?.());
        }
        if (target === 'performance') {
          const perfTab = document.getElementById('tab-performance');
          if (perfTab && !perfTab.__initFired) {
            perfTab.__initFired = true;
            perfTab.dispatchEvent(new Event('click'));
          }
        }
      }
      function fromHash() {
        const h = (location.hash || '#pump').slice(1).toLowerCase();
        activate(panes[h] ? h : 'pump');
      }
      window.addEventListener('hashchange', fromHash);
      links.forEach(a => a.addEventListener('click', (e) => {
        e.preventDefault();
        location.hash = a.getAttribute('href');
      }));
      fromHash();
    })();
  </script>

  <!-- Charts + stats + Performance logic -->
  <script src="script.js"></script>
</body>
</html>
